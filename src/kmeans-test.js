module('Kmeans tests');
test("Sanity Checks", function() {
  var data = [[1, 2]];
  raises(function(){new Kmeans()}, 'Given inputData cannot be empty', "inputData empty checking passed");
  raises(function(){new Kmeans([])}, 'Given inputData cannot be empty', "inputData empty checking 2 passed");
  raises(function(){new Kmeans(data)}, 'Given initialCentroids cannot be empty', "initialCentroids empty checking passed");  
  raises(function(){new Kmeans(data, [])}, 'Given initialCentroids cannot be empty', "initialCentroids empty checking 2 passed");
  raises(function(){new Kmeans(data, data, 'a')}, 'maxIters must be an integer > 0', "maxIters can't accept string");
  raises(function(){new Kmeans(data, data)}, 'maxIters must be an integer > 0', "maxIters can't be empty");
  raises(function(){new Kmeans(data, data, 0)}, 'maxIters must be an integer > 0', "maxIters can't accept 0");
  raises(function(){new Kmeans(data, data, -2)}, 'maxIters must be an integer > 0', "maxIters can't accept negative numbers");
  raises(function(){new Kmeans(data, data, 2.1)}, 'maxIters must be an integer > 0', "maxIters can't accept floats");
});

function roundNumber(number, digits) {
     var multiple = Math.pow(10, digits);
     var rndedNum = Math.round(number * multiple) / multiple;
     return rndedNum;
}


test('kmeans helper functions', function() {
  var inputData = [
[1.84208,  4.60757],
[5.65858,  4.79996],
[6.35258,  3.29085],
[2.90402,  4.61220],
[3.23198,  4.93989],
[1.24792,  4.93268],
[1.97620,  4.43490],
[2.23454,  5.05547],
[2.98341,  4.84046],
[2.97970,  4.80671],
[2.11496,  5.37374],
[2.12170,  5.20854],
[1.51435,  4.77003],
[2.16979,  5.27435],
[0.41852,  4.88313],
[2.47054,  4.80419],
[4.06069,  4.99504],
[3.00709,  4.67898],
[0.66632,  4.87188],
[3.16219,  4.83658],
[0.51155,  4.91053],
[3.13428,  4.96178],
[2.04975,  5.62414],
[0.66583,  5.24399],
[1.01732,  4.84474],
[2.17894,  5.29759],
[2.85963,  5.26042],
[1.30883,  5.30159],
[0.99253,  5.01567],
[1.40373,  4.57528],
[2.66047,  5.19624],
[2.79996,  5.11526],
[2.06995,  4.68467],
[3.29765,  5.59206],
[1.89298,  4.89043],
[2.55983,  5.26398],
[1.15354,  4.67867],
[2.25151,  5.44500],
[2.20960,  4.91469],
[1.59142,  4.83213],
[1.67838,  5.26904],
[2.59149,  4.92593],
[2.80996,  5.53850],
[0.95312,  5.58037],
[1.51775,  5.03837],
[3.23114,  5.78430],
[2.54180,  4.81099],
[3.81423,  4.73527],
[1.68496,  4.59644],
[2.17777,  4.86154],
[1.81733,  5.13334],
[1.85777,  4.86962],
[3.03084,  5.24058],
[2.92658,  5.09668],
[3.43494,  5.34081],
[3.20367,  4.85925],
[0.10512,  4.72916],
[1.40598,  5.06637],
[2.24185,  4.92446],
[1.36678,  5.26161],
[1.70725,  4.04231],
[1.91910,  5.57848],
[1.60157,  4.64453],
[0.37963,  5.26195],
[2.02135,  4.41267],
[1.12037,  5.20881],
[2.26901,  4.61819],
[-0.24513,  5.74019],
[2.12858,  5.01150],
[1.84420,  5.03154],
[2.32558,  4.74868],
[1.52334,  4.87916],
[1.02285,  5.01051],
[1.85383,  5.00752],
[2.20322,  4.94516],
[1.20100,  4.57830],
[1.02063,  4.62991],
[1.60493,  5.13663],
[0.47647,  5.13536],
[0.36392,  4.73333],
[0.31320,  5.54695],
[2.28665,  5.00767],
[2.15460,  5.46283],
[2.05289,  4.77959],
[4.88804,  5.50671],
[2.40305,  5.08147],
[2.56869,  5.20688],
[1.82976,  4.59657],
[0.54845,  5.02673],
[3.17110,  5.59465],
[3.04202,  5.00758],
[2.40428,  5.02587],
[0.17783,  5.29765],
[2.61429,  5.22287],
[2.30098,  4.97236],
[3.90779,  5.09465],
[2.05671,  5.23391],
[1.38133,  5.00195],
[1.16074,  4.67728],
[1.72818,  5.36028],
[3.20361,  0.72221],
[3.06193,  1.57192],
[4.01715,  1.16071],
[1.40261,  1.08727],
[4.08165,  0.87200],
[3.15273,  0.98156],
[3.45186,  0.42784],
[3.85384,  0.79205],
[1.57449,  1.34811],
[4.72372,  0.62044],
[2.87961,  0.75414],
[0.96791,  1.16167],
[1.53178,  1.10055],
[4.13836,  1.24781],
[3.16109,  1.29423],
[2.95177,  0.89583],
[3.27844,  1.75044],
[2.12702,  0.95672],
[3.32649,  1.28019],
[2.54371,  0.95733],
[3.23395,  1.08202],
[4.43153,  0.54041],
[3.56479,  1.11765],
[4.25588,  0.90644],
[4.05387,  0.53292],
[3.08970,  1.08814],
[2.84734,  0.26759],
[3.63586,  1.12160],
[1.95539,  1.32157],
[2.88384,  0.80455],
[3.48444,  1.13551],
[3.49798,  1.10046],
[2.45576,  0.78905],
[3.20380,  1.02728],
[3.00677,  0.62519],
[1.96548,  1.21731],
[2.17989,  1.30880],
[2.61207,  0.99077],
[3.95550,  0.83269],
[3.64846,  1.62850],
[4.18450,  0.45356],
[3.78757,  1.45443],
[3.30064,  1.28108],
[3.02836,  1.35635],
[3.18412,  1.41411],
[4.16912,  0.20581],
[3.24024,  1.14876],
[3.91596,  1.01226],
[2.96980,  1.01210],
[1.12994,  0.77085],
[2.71731,  0.48698],
[3.11890,  0.69438],
[2.40518,  1.11778],
[2.95818,  1.01887],
[1.65456,  1.18631],
[2.39776,  1.24721],
[2.28409,  0.64865],
[2.79589,  0.99527],
[3.41156,  1.15964],
[3.50664,  0.73878],
[3.93616,  1.46203],
[3.90207,  1.27779],
[2.61036,  0.88028],
[4.37272,  1.02914],
[3.08349,  1.19633],
[2.11599,  0.79304],
[2.15653,  0.40359],
[2.14491,  1.13582],
[1.84936,  1.02233],
[4.15908,  0.61721],
[2.76494,  1.43149],
[3.90561,  1.16575],
[2.54072,  0.98393],
[4.27783,  1.18014],
[3.31058,  1.03124],
[2.15521,  0.80697],
[3.71364,  0.45813],
[3.54010,  0.86446],
[1.60520,  1.10981],
[1.75164,  0.68854],
[3.12405,  0.67822],
[2.37199,  1.42790],
[2.53446,  1.21562],
[3.68345,  1.22835],
[3.26701,  0.32057],
[3.94159,  0.82577],
[3.26455,  1.38369],
[4.30471,  1.10726],
[2.68499,  0.35345],
[3.12635,  1.28069],
[2.94294,  1.02825],
[3.11877,  1.33285],
[2.02359,  0.44772],
[3.62203,  1.28644],
[2.42866,  0.86499],
[2.09517,  1.14010],
[5.29239,  0.36873],
[2.07292,  1.16764],
[0.94623,  0.24522],
[2.73912,  1.10072],
[6.00507,  2.72784],
[6.05696,  2.94970],
[6.77013,  3.21411],
[5.64035,  2.69385],
[5.63325,  2.99002],
[6.17443,  3.29026],
[7.24695,  2.96877],
[5.58163,  3.33510],
[5.36272,  3.14681],
[4.70776,  2.78711],
[7.42892,  3.46679],
[6.64107,  3.05999],
[6.37474,  2.56253],
[7.28780,  2.75180],
[6.20295,  2.67856],
[5.38736,  2.26737],
[5.66731,  2.96478],
[6.59702,  3.07082],
[7.75661,  3.15604],
[6.63263,  3.14799],
[5.76635,  3.14272],
[5.99423,  2.75708],
[6.37870,  2.65022],
[5.74036,  3.10391],
[4.61652,  2.79321],
[5.33534,  3.03929],
[5.37294,  2.81685],
[5.03611,  2.92486],
[5.52909,  3.33682],
[6.05087,  2.80703],
[5.13201,  2.19812],
[5.73285,  2.87738],
[6.78111,  3.05677],
[6.44834,  3.35299],
[6.39941,  2.89757],
[5.86068,  2.99577],
[6.44765,  3.16561],
[5.36708,  3.19503],
[5.88736,  3.34616],
[3.96162,  2.72025],
[6.28438,  3.17361],
[4.20585,  2.81647],
[5.32616,  3.03314],
[7.17135,  3.41227],
[7.49493,  2.84019],
[7.39807,  3.48487],
[5.02433,  2.98683],
[5.31712,  2.81741],
[5.87655,  3.21661],
[6.03763,  2.68304],
[5.91280,  2.85632],
[6.69451,  2.89056],
[6.01018,  2.72401],
[6.92722,  3.19960],
[6.33560,  3.30864],
[6.24257,  2.79179],
[5.57812,  3.24766],
[6.40774,  2.67555],
[6.80030,  3.17580],
[7.21684,  2.72897],
[6.51101,  2.72732],
[4.60631,  3.32946],
[7.65503,  2.87096],
[5.50296,  2.62925],
[6.63061,  3.01502],
[3.45928,  2.68478],
[8.20340,  2.41693],
[4.95679,  2.89776],
[5.37053,  2.44955],
[5.69798,  2.94977],
[6.27376,  2.24256],
[5.05275,  2.75692],
[6.88576,  2.88845],
[4.18774,  2.89283],
[5.97510,  3.02592],
[6.09457,  2.61868],
[5.72396,  3.04454],
[4.37250,  3.05488],
[6.29206,  2.77574],
[5.14533,  4.13226],
[6.58706,  3.37508],
[5.78769,  3.29255],
[6.72798,  3.00440],
[6.64079,  2.41069],
[6.23229,  2.72851],
[6.21773,  2.80995],
[5.78116,  3.07988],
[6.62447,  2.74454],
[5.19591,  3.06973],
[5.87177,  3.25518],
[5.89562,  2.89844],
[5.61754,  2.59751],
[5.63176,  3.04759],
[5.50259,  3.11869],
[6.48213,  2.55085],
[7.30279,  3.38016],
[6.99198,  2.98707],
[4.82553,  2.77962],
[6.11768,  2.85476],
[0.94049,  5.71557]
  ];
  var expectedVal = [
[0],
[2],
[1],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[1],
[0],
[0],
[0],
[0],
[1],
[0],
[0],
[0],
[1],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[1],
[0],
[1],
[1],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[1],
[0],
[1],
[0],
[0],
[0],
[0],
[1],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[1],
[0],
[0],
[0],
[0],
[0],
[1],
[0],
[0],
[0],
[1],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[1],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[0],
[1],
[0],
[0],
[0],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[2],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[2],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[0],
[1],
[0],
[1],
[2],
[1],
[2],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[0],
[1],
[1],
[1],
[0],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[0],
[1],
[1],
[1],
[0],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[1],
[2],
[1],
[1],
[1],
[0]
];
  var initialCentroids = [[3,3], [6, 2], [8, 5]];
  var maxIters = 100;
  kmeans = new Kmeans(inputData, initialCentroids, maxIters);
  
  var myCentroids = kmeans.findClosestCentroids();
  deepEqual(myCentroids, expectedVal, 'findClosestCentroids returns the expected centroids');
  
   expectedVal = [
   [2.4283, 3.1579],
   [5.8135, 2.6337],
   [7.1194, 3.6167],   
  ];
  var computedCentroids = kmeans.computeCentroids(inputData, myCentroids, 3);
  //Round computedCentroids to 4 decimal places
  var i,j;
  for(i = 0; i < computedCentroids.length; i++) {
    for(j = 0; j < computedCentroids[i].length; j++) {
      computedCentroids[i][j] = roundNumber(computedCentroids[i][j], 4);
    }
  }
  deepEqual(computedCentroids, expectedVal, 'computeCentroids returns the expected centroid positions');
  
});